<!DOCTYPE HTML>
<!--
	Main index file for My eFridge project for ElleHacks 2022.

	Starting template credit to:
	Fractal by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>My eFridge</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<link rel="icon" href="images/fridge.png">
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
	</head>
	<body class="is-preload">

		<!-- Header -->
		<header id="header">
			<div class="content" style="max-width: 40%;">
				<h1>
					<a href="#">My eFridge</a>
					<img src="images/fridge.png" alt="" />
				</h1>
				<p>Reduce waste, learn new recipes, save money!</p>
				<ul class="actions">
					<!-- Input food information: food, quantity, expiration date (optional), type -->
					<div class="col">
						<form action="#" id="food-info" onsubmit="return false;">
							<h4>Enter food item information below:</h4>
							<div class="col gtr-uniform" id="food-form">
								<div class="col-6 col-12-xsmall">
									<input type="text" name="demo-name" id="food-item" value="" placeholder="Food Item" style="margin-top: 1%;" required/>
								</div>
								<div class="col-6 col-12-xsmall">
									<input type="text" name="demo-email" id="food-amt" value="" placeholder="Amount" style="margin-top: 1%;"/>
								</div>
								<div class="row" style="margin-top: 1%;">
									<form action="#" onsubmit="return false;" id="extra-food-info">
										<div class="col-12">
											<select id="has-exp" name="has-exp" required>
												<option value="">Does this food item have an expiration date labelled?</option>
												<option value="Yes">Yes</option>
												<option value="No">No</option>
											</select>
											<input style="margin-top: 1%;" type="submit" onclick="addExpirationInput();" id="set-input" />
										</div>
									</form>	
								</div>
							</div>
							<div>
								<a href="#" class="button primary" style="margin-bottom: 1%;" onclick="deleteFoodItem();">Delete food item</a>
								<a href="#" class="button primary" style="margin-bottom: 1%;" onclick="addExpiration(); saveFoodItem();">Save food item</a>
							</div>
						</form>
						<!-- Button will lead to recipe generation website -->
						<li><a button onclick="location.href = 'https://recipegpt.org/';" target="_blank" id="recipeButton" href="#one" class="button primary" style="margin-bottom: 1%;">Make a recipe with what you have!</a></li>
						<!-- Button will lead to more information on how to use My eFridge -->
						<li><a href="#one" class="button icon solid fa-chevron-down scrolly">Learn More</a></li>
					</div>
				</ul>
			</div>
			<!-- Table to display information in fridge -->
			<div style="min-width: 30%;">
				<iframe src="https://calendar.google.com/calendar/embed?height=300&wkst=1&bgcolor=%23ffffff&ctz=America%2FToronto&showTitle=0&showNav=1&showPrint=0&showTabs=0&showTz=0&showCalendars=0&src=NGM3ZTVxZGNjb3Vqbmt0cGcwbThjbW1rMW9AZ3JvdXAuY2FsZW5kYXIuZ29vZ2xlLmNvbQ&color=%237986CB" style="border-width:0" width="400" height="300" frameborder="0" scrolling="no"></iframe>
				<section>
					<div class="table-wrapper" style="max-height: 256px;">
						<h5>Currently in the fridge:</h5>
						<table class="alt" id="fridge-table" style="overflow-y: scroll; overflow-x: hidden; background-color: aliceblue;">
							<thead>
								<tr>
									<th style="color:#4696e5">Food Item</th>
									<th style="color:#4696e5">Expiration Date</th>
									<th style="color:#4696e5">Amount Remaining</th>
								</tr>
							</thead>
							<tbody>
							</tbody>
						</table>
					</div>
				</section>
			</div>
		</header>

		<!-- About and How to Use My eFridge -->
		<section id="one" class="wrapper style2 special">
			<header class="major">
				<h2>About and How to Use My eFridge</h2>
			</header>
			<p>
				My eFridge allows businesses and household to keep track of items in their fridge.<br>
				It does this through the functionality below.
			</p>
		</section>

		<!-- Explanation of My eFridge functionality -->
		<section id="two" class="wrapper">
			<div class="inner alt">
				<section class="spotlight">
					<div class="image"><img src="images/insideFridge.jpg" alt="" /></div>
					<div class="content">
						<h3>Storing Fridge Items</h3>
						<p>
							Users can input information about items (name, amount, expiration date, type) in their fridge.
							This is done through the input containers to the left of the fridge.
						</p>
					</div>
				</section>
				<section class="spotlight">
					<div class="image"><img src="images/calendar.jpg" alt="" /></div>
					<div class="content">
						<h3>Calendar with Expiration Dates</h3>
						<p>
							Users receive alerts about items in their fridge with upcoming expiration dates.
							This will allow them to make decisions (e.g., use/donate) to reduce waste.
						</p>
					</div>
				</section>
				<section class="spotlight">
					<div class="image"><img src="images/recipe.jpg" alt="" /></div>
					<div class="content">
						<h3>AI Recipe Generator</h3>
						<p>
							My eFridge leverages an AI Recipe Generator to offer users ideas on how to use items with upcoming expiration dates.
						</p>
					</div>
				</section>
			</div>
		</section>

		<!-- Footer -->
		<footer id="footer">
			<p class="copyright">&copy; My eFridge. Starting template credits: <a href="http://html5up.net">HTML5 UP</a></p>
		</footer>

		<!-- Scripts -->
		<script>
				var expires_in = 0;//global variable to store when an item expires
				var expiration_date;
				function addExpirationInput() {

					var has_exp = document.getElementById("has-exp").value;

					if (has_exp=="Yes") {
						var node = "<div class='col-6 col-12-xsmall' flex='50'>\
										<input type='text' name='demo-email' id='food-exp-date' value='' placeholder='Expiration Date mm/dd/yyyy' style='margin-top: 1%;'/>\
									<div/>\
									<div>\
										<a href='#' class='button primary' style='margin-top: 1%;' onclick='addExpiration(); saveFoodItem();'>Save food item</a>\
									</div>";                          
						document.getElementById ("food-form").insertAdjacentHTML('beforeEnd', node);
					}
					else{
						var node = "<div class='col-12'>\
										<select name='food-type' id='food-type' style='margin-top: 1%;'>\
										<option value=''>Select Food Type</option>\
										<option value='Fresh meat'>Fresh meat - steak, beef flank</option>\
										<option value='Fresh poultry'>Fresh poultry - chicken breast, turkey breast</option>\
										<option value='Fresh fish'>Fresh fish - salmon, tuna</option>\
										<option value='Deli meats'>Deli meats - ham</option>\
										<option value='Eggs'>Eggs</option>\
										<option value='Berries'>Berries - raspberries, blueberries</option>\
										<option value='Stem'>Edible plant stem – celery, asparagus</option>\
										<option value='Marrow'>Marrow – cucumber, zucchini</option>\
										<option value='Allium'>Allium - garlic, onion</option>\
										<option value='Leafy'>Leafy Greens - lettuce, spinach</option>\
										<option value='Cruciferous'>Cruciferous - broccoli, cabbage</option>\
									</select>\
								</div>\
								<div>\
									<a href='#' class='button primary' style='margin-top: 1%;' onclick='addExpiration(); saveFoodItem();'>Save food item</a>\
								</div>";                        
						document.getElementById ("food-form").insertAdjacentHTML('beforeEnd', node);
					}
					var old_submit = document.getElementById("set-input");
					old_submit.remove();
				}
				function addExpiration() {
							var optional_expiration = document.getElementById("has-exp");
							var input = document.getElementById("food-item").value.toLowerCase();
							var has_exp = document.getElementById("has-exp").value;
							if (has_exp=="No"){
								var type = document.getElementById("food-type").value;
								if (type=="Fresh poultry"||type=="Fresh fish"){
									expires_in = 2;
								}
								if (type=="Stem"){
									expires_in = 4;
								}
								if (type=="Marrow"||type=="Leafy"||type=="Cruciferous"||type=="Fresh meat"){
									expires_in = 5;
								}
								if (type=="Berries"){
									expires_in = 14;
								}
								if (type=="Allium"){
									expires_in = 30;
								}
								
								if (type=="Eggs"){
									expires_in = 35;
								}
								var today= new Date();
								expiration_date = new Date();
								expiration_date.setDate(today.getDate()+expires_in);
								var dd = String(expiration_date.getDate()).padStart(2, '0');
								var mm = String(expiration_date.getMonth() + 1).padStart(2, '0'); //January is 0!
								var yyyy = expiration_date.getFullYear();
								expiration_date = mm + '/' + dd + '/' + yyyy;
							}
							else{
								expiration_date = document.getElementById("food-exp-date").value;
							}
							
							alert("Hey there! That " + input + " expires on " + expiration_date + ".");
							
			}

			// Global variable to hold all items in the fridge.
			var allFridgeItems = [
				{foodItem:"butter", foodAmount: "1", foodExpDate: "02/17/2022"},
				{foodItem:"milk", foodAmount: "2", foodExpDate: "02/20/2022"},
				{foodItem:"eggs", foodAmount: "12", foodExpDate: "02/25/2022"}, 
				{foodItem:"apples", foodAmount: "2", foodExpDate: "02/20/2022"},
				{foodItem:"pickles", foodAmount: "1", foodExpDate: "12/01/2022"},
				{foodItem:"ham", foodAmount: "2", foodExpDate: "02/20/2022"},
				{foodItem:"milk", foodAmount: "2", foodExpDate: "02/20/2022"}];

			populateTable();

			//Function to populate fridge table.
			function populateTable() {
				const tbody = document.querySelector('tbody');

				//Clear out previous table entries.
				document.querySelectorAll("table tbody tr").forEach(function(e){e.remove()})

				//Order table entries so that earliest expiration date is on top.
				allFridgeItems.sort((a,b) => (a.foodExpDate > b.foodExpDate) ? 1 : (b.foodExpDate > a.foodExpDate) ? -1 : 0);

				allFridgeItems.forEach(item => {
					const tr = tbody.insertRow();
					tr.insertCell().innerText = item.foodItem;
					tr.insertCell().innerText = item.foodExpDate;
					tr.insertCell().innerText = item.foodAmount;
				})
			}
			
			//Function to save inputted food items.
			function saveFoodItem() {
				var foodObj = { 
					foodItem: document.getElementById("food-item").value ? document.getElementById("food-item").value : '', 
					foodAmount: document.getElementById("food-amt").value ? document.getElementById("food-amt").value : '', 
					foodExpDate: expiration_date
				};

				//Add new object to allFridgeItems.
				allFridgeItems.push(foodObj);

				//Add new object to fridge table.
				populateTable();
			}

			//Function to delete food item.
			function deleteFoodItem() {
				var foodItemToDelete = document.getElementById("food-item").value;
				var amountToDelete = document.getElementById("food-amt").value;
				for (var i = 0; i < allFridgeItems.length; i++) {
					if (allFridgeItems[i].foodItem === foodItemToDelete) {
						//Case 1: deleting amount is less than remaining.
						if (allFridgeItems[i].foodAmount > amountToDelete) {
							allFridgeItems[i].foodAmount = allFridgeItems[i].foodAmount - amountToDelete;
							populateTable();
						}
						//Case 2: deleting all remaining amount.
						else {
							allFridgeItems.splice(i, 1);
							populateTable();
						}
					}
				}
			}

		</script>
		<script src="assets/js/jquery.min.js"></script>
		<script src="assets/js/jquery.scrolly.min.js"></script>
		<script src="assets/js/browser.min.js"></script>
		<script src="assets/js/breakpoints.min.js"></script>
		<script src="assets/js/util.js"></script>
		<script src="assets/js/main.js"></script>
	</body>
</html>